name: postgres
description: PostgreSQL database for metadata and operational storage
category: core
default: true

image: postgres:16-alpine

compose:
  restart: unless-stopped
  environment:
    POSTGRES_USER: ${POSTGRES_USER:-phlo}
    POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-phlo}
    POSTGRES_DB: ${POSTGRES_DB:-phlo}
  ports:
    - "${POSTGRES_PORT:-5432}:5432"
  volumes:
    - ./volumes/postgres:/var/lib/postgresql/data
  healthcheck:
    test: ["CMD-SHELL", "pg_isready -U ${POSTGRES_USER:-phlo}"]
    interval: 10s
    timeout: 5s
    retries: 10

env_vars:
  POSTGRES_USER:
    default: phlo
    description: PostgreSQL username
  POSTGRES_PASSWORD:
    default: phlo
    description: PostgreSQL password
    secret: true
  POSTGRES_DB:
    default: phlo
    description: PostgreSQL database name
  POSTGRES_PORT:
    default: 5432
    description: PostgreSQL host port
