# Companion service for minio - creates required buckets
name: minio-setup
description: Initialize MinIO buckets for data lake
category: core
default: true

image: minio/mc:latest

depends_on:
  - minio

compose:
  restart: "no"
  environment:
    MINIO_ROOT_USER: ${MINIO_ROOT_USER:-minio}
    MINIO_ROOT_PASSWORD: ${MINIO_ROOT_PASSWORD:-minio123}
  entrypoint: >
    /bin/sh -c "
    sleep 5 &&
    mc alias set myminio http://minio:9000 $${MINIO_ROOT_USER} $${MINIO_ROOT_PASSWORD} &&
    mc mb --ignore-existing myminio/lake &&
    mc mb --ignore-existing myminio/lake/warehouse &&
    mc mb --ignore-existing myminio/lake/stage &&
    echo 'Buckets created successfully'
    "
