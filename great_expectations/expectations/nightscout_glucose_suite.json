{
  "data_asset_type": "Dataset",
  "expectation_suite_name": "nightscout_glucose_suite",
  "meta": {
    "great_expectations_version": "0.18.0"
  },
  "expectations": [
    {
      "expectation_type": "expect_table_row_count_to_be_between",
      "kwargs": {
        "min_value": 1,
        "max_value": 100000
      },
      "meta": {
        "notes": "Should have at least 1 reading, max ~100k for reasonable time window"
      }
    },
    {
      "expectation_type": "expect_column_values_to_not_be_null",
      "kwargs": {
        "column": "glucose_mg_dl"
      },
      "meta": {
        "notes": "Glucose readings must always have a value"
      }
    },
    {
      "expectation_type": "expect_column_values_to_be_between",
      "kwargs": {
        "column": "glucose_mg_dl",
        "min_value": 20,
        "max_value": 600,
        "mostly": 0.99
      },
      "meta": {
        "notes": "Physiologically plausible glucose range - allows 1% outliers for sensor errors"
      }
    },
    {
      "expectation_type": "expect_column_values_to_not_be_null",
      "kwargs": {
        "column": "reading_timestamp"
      },
      "meta": {
        "notes": "Every reading must have a timestamp"
      }
    },
    {
      "expectation_type": "expect_column_values_to_be_in_set",
      "kwargs": {
        "column": "direction",
        "value_set": [
          "DoubleUp",
          "SingleUp",
          "FortyFiveUp",
          "Flat",
          "FortyFiveDown",
          "SingleDown",
          "DoubleDown",
          "NOT COMPUTABLE",
          "RATE OUT OF RANGE"
        ]
      },
      "meta": {
        "notes": "Direction must be valid Dexcom trend arrow"
      }
    },
    {
      "expectation_type": "expect_column_values_to_be_in_set",
      "kwargs": {
        "column": "glucose_category",
        "value_set": [
          "hypoglycemia",
          "in_range",
          "hyperglycemia_mild",
          "hyperglycemia_severe"
        ]
      },
      "meta": {
        "notes": "Glucose category must be valid"
      }
    },
    {
      "expectation_type": "expect_column_values_to_be_between",
      "kwargs": {
        "column": "hour_of_day",
        "min_value": 0,
        "max_value": 23
      },
      "meta": {
        "notes": "Hour must be 0-23"
      }
    },
    {
      "expectation_type": "expect_column_values_to_be_between",
      "kwargs": {
        "column": "day_of_week",
        "min_value": 0,
        "max_value": 6
      },
      "meta": {
        "notes": "Day of week must be 0-6 (Sunday-Saturday)"
      }
    },
    {
      "expectation_type": "expect_column_mean_to_be_between",
      "kwargs": {
        "column": "glucose_mg_dl",
        "min_value": 80,
        "max_value": 250
      },
      "meta": {
        "notes": "Average glucose should be in reasonable range for someone managing diabetes"
      }
    }
  ]
}
