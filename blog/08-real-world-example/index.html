
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the Phlo data lakehouse platform">
      
      
        <meta name="author" content="Phlo Team">
      
      
      
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Part 8: Real-World Exampleâ€”Building a Complete Data Pipeline - Phlo Lakehouse Platform</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#part-8-real-world-examplebuilding-a-complete-data-pipeline" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Phlo Lakehouse Platform" class="md-header__button md-logo" aria-label="Phlo Lakehouse Platform" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Phlo Lakehouse Platform
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Part 8: Real-World Exampleâ€”Building a Complete Data Pipeline
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Phlo Lakehouse Platform" class="md-nav__button md-logo" aria-label="Phlo Lakehouse Platform" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Phlo Lakehouse Platform
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../getting-started/installation/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../guides/developer-guide/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../setup/hasura/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Setup
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../packages/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Packages
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../reference/architecture/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../operations/operations-guide/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    Operations
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-use-case" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Use Case
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Architecture
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-understanding-the-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Understanding the API
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-data-ingestion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Data Ingestion
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Data Ingestion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-phlo_ingestion-decorator" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using @phlo_ingestion Decorator
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-bronze-layer-transformation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Bronze Layer Transformation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 3: Bronze Layer Transformation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dbt-model-staging" class="md-nav__link">
    <span class="md-ellipsis">
      
        dbt Model: Staging
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-silver-layer-transformation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: Silver Layer Transformation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: Silver Layer Transformation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dbt-model-enriched-facts" class="md-nav__link">
    <span class="md-ellipsis">
      
        dbt Model: Enriched Facts
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-gold-layer-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 5: Gold Layer Metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 5: Gold Layer Metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dbt-model-summarized-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        dbt Model: Summarized Metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-publishing-to-postgres" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 6: Publishing to Postgres
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 6: Publishing to Postgres">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dbt-model-bi-ready-marts" class="md-nav__link">
    <span class="md-ellipsis">
      
        dbt Model: BI-Ready Marts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto-publishing-iceberg-marts-postgres" class="md-nav__link">
    <span class="md-ellipsis">
      
        Auto-Publishing: Iceberg Marts â†’ Postgres
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-7-running-the-full-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 7: Running the Full Pipeline
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 7: Running the Full Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#materialize-everything" class="md-nav__link">
    <span class="md-ellipsis">
      
        Materialize Everything
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-8-monitoring-and-alerts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 8: Monitoring and Alerts
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 8: Monitoring and Alerts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quality-checks-with-phlo_quality" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quality Checks with @phlo_quality
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#complete-data-flow-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete Data Flow Diagram
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Takeaways
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Next Steps
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="part-8-real-world-examplebuilding-a-complete-data-pipeline">Part 8: Real-World Exampleâ€”Building a Complete Data Pipeline</h1>
<p>We've covered all the pieces. Now let's build a complete, working pipeline from start to finish: <strong>Nightscout Glucose Monitoring</strong>.</p>
<h2 id="the-use-case">The Use Case</h2>
<p><strong>Nightscout</strong> is an open-source glucose monitoring system used by people with diabetes. It sends glucose readings every 5 minutes to a cloud API.</p>
<p><strong>Goal</strong>: Build analytics to understand:</p>
<ul>
<li>Daily glucose averages and ranges</li>
<li>Time spent in range (70-180 mg/dL)</li>
<li>Hour-by-hour patterns</li>
<li>Overnight stability</li>
</ul>
<h2 id="the-architecture">The Architecture</h2>
<pre><code>Nightscout API
  â†“ (5-min readings)
Phlo Ingestion
  â”œâ”€ DLT stages to S3
  â”œâ”€ PyIceberg merges to raw.glucose_entries
  â””â”€ Nessie tracks via snapshot
    â†“
dbt Transformation
  â”œâ”€ Bronze: stg_glucose_entries (staging)
  â”œâ”€ Silver: fct_glucose_readings (enriched)
  â”œâ”€ Gold: dim_date, mrt_glucose_readings (metrics)
  â””â”€ Marts: mrt_glucose_overview (aggregated)
    â†“
Postgres Publishing
  â””â”€ Superset Dashboard
</code></pre>
<h2 id="step-1-understanding-the-api">Step 1: Understanding the API</h2>
<p>Nightscout's glucose API:</p>
<pre><code class="language-bash"># Fetch glucose readings
curl &quot;https://gwp-diabetes.fly.dev/api/v1/entries.json&quot; \
  -G \
  --data-urlencode 'count=10000' \
  --data-urlencode 'find[dateString][$gte]=2024-10-15T00:00:00.000Z' \
  --data-urlencode 'find[dateString][$lt]=2024-10-15T23:59:59.999Z'

# Response:
[
  {
    &quot;_id&quot;: &quot;507f1f77bcf86cd799439011&quot;,  # MongoDB ObjectId
    &quot;sgv&quot;: 145,                          # Glucose in mg/dL
    &quot;date&quot;: 1729027800000,               # Unix ms
    &quot;dateString&quot;: &quot;2024-10-15T10:30:00.000Z&quot;,
    &quot;direction&quot;: &quot;Flat&quot;,                 # Trend direction
    &quot;trend&quot;: 0,                          # Numeric trend
    &quot;device&quot;: &quot;share2&quot;,                  # Device type
    &quot;type&quot;: &quot;sgv&quot;,                       # Type
    &quot;rssi&quot;: 100,                         # Signal strength
  },
  ...
]
</code></pre>
<h2 id="step-2-data-ingestion">Step 2: Data Ingestion</h2>
<h3 id="using-phlo_ingestion-decorator">Using @phlo_ingestion Decorator</h3>
<p>Phlo simplifies ingestion with the <code>@phlo_ingestion</code> decorator that handles validation, staging, and Iceberg merging:</p>
<pre><code class="language-python"># File: phlo-examples/nightscout/workflows/ingestion/nightscout/readings.py

import phlo
from dlt.sources.rest_api import rest_api
from workflows.schemas.nightscout import RawGlucoseEntries

@phlo_ingestion(
    table_name=&quot;glucose_entries&quot;,
    unique_key=&quot;_id&quot;,
    validation_schema=RawGlucoseEntries,
    group=&quot;nightscout&quot;,
    cron=&quot;0 */1 * * *&quot;,
    freshness_hours=(1, 24),
)
def glucose_entries(partition_date: str):
    &quot;&quot;&quot;
    Ingest Nightscout glucose entries using DLT rest_api source.

    Features:
    - Idempotent ingestion: safe to run multiple times without duplicates
    - Deduplication based on _id field (Nightscout's unique entry ID)
    - Daily partitioning by timestamp
    - Automatic validation with Pandera schema
    - Branch-aware writes to Iceberg

    Args:
        partition_date: Date partition in YYYY-MM-DD format

    Returns:
        DLT resource for glucose entries, or None if no data
    &quot;&quot;&quot;
    start_time_iso = f&quot;{partition_date}T00:00:00.000Z&quot;
    end_time_iso = f&quot;{partition_date}T23:59:59.999Z&quot;

    source = rest_api(
        client={
            &quot;base_url&quot;: &quot;https://gwp-diabetes.fly.dev/api/v1&quot;,
        },
        resources=[
            {
                &quot;name&quot;: &quot;entries&quot;,
                &quot;endpoint&quot;: {
                    &quot;path&quot;: &quot;entries.json&quot;,
                    &quot;params&quot;: {
                        &quot;count&quot;: 10000,
                        &quot;find[dateString][$gte]&quot;: start_time_iso,
                        &quot;find[dateString][$lt]&quot;: end_time_iso,
                    },
                },
            }
        ],
    )

    return source
</code></pre>
<p><strong>What the @phlo_ingestion decorator does automatically</strong>:</p>
<ol>
<li>Creates Dagster asset with daily partitioning</li>
<li>Runs DLT pipeline to fetch and stage data to parquet</li>
<li>Validates with RawGlucoseEntries Pandera schema</li>
<li>Creates Iceberg table if it doesn't exist</li>
<li>Merges data idempotently using <code>_id</code> as unique key</li>
<li>Adds freshness checks and cron scheduling</li>
<li>Returns MaterializeResult with metadata</li>
</ol>
<p><strong>Run it</strong>:</p>
<pre><code class="language-bash">phlo materialize --select dlt_glucose_entries --partition 2024-10-15
</code></pre>
<h2 id="step-3-bronze-layer-transformation">Step 3: Bronze Layer Transformation</h2>
<h3 id="dbt-model-staging">dbt Model: Staging</h3>
<pre><code class="language-sql">-- File: workflows/transforms/dbt/models/bronze/stg_glucose_entries.sql

{{ config(
    materialized='view',
    tags=['nightscout', 'stg']
) }}

WITH raw_data AS (
    SELECT * FROM {{ source('dagster_assets', 'glucose_entries') }}
)

SELECT
    -- Rename and type columns
    _id as entry_id,
    CAST(sgv AS INT) as glucose_mg_dl,
    CAST(date_string AS TIMESTAMP) as reading_timestamp,
    date_string as timestamp_iso,
    direction,
    trend,
    device,
    type as reading_type,
    CAST(utc_offset AS INT) as utc_offset_minutes,

    -- Metadata
    _cascade_ingested_at as ingested_at,
    _dlt_load_id,
    _dlt_id

FROM raw_data

-- Data quality filters
WHERE sgv IS NOT NULL
  AND sgv BETWEEN 20 AND 600  -- Physiologically plausible
  {% if var('partition_date_str', None) is not none %}
    AND DATE(date_string) = DATE('{{ var(&quot;partition_date_str&quot;) }}')
  {% endif %}
</code></pre>
<p><strong>Purpose</strong>:</p>
<ul>
<li>Clean types (string â†’ timestamp)</li>
<li>Rename for clarity (_id â†’ entry_id)</li>
<li>Filter out bad data (null, out-of-range)</li>
</ul>
<h2 id="step-4-silver-layer-transformation">Step 4: Silver Layer Transformation</h2>
<h3 id="dbt-model-enriched-facts">dbt Model: Enriched Facts</h3>
<pre><code class="language-sql">-- File: workflows/transforms/dbt/models/silver/fct_glucose_readings.sql

{{ config(
    materialized='table',
    tags=['nightscout', 'int']
) }}

WITH glucose_data AS (
    SELECT * FROM {{ ref('stg_glucose_entries') }}
),

enriched AS (
    SELECT
        entry_id,
        glucose_mg_dl,
        reading_timestamp,
        timestamp_iso,
        direction,
        device,

        -- Time dimensions
        DATE(reading_timestamp) as reading_date,
        EXTRACT(HOUR FROM reading_timestamp) as hour_of_day,
        DAY_OF_WEEK(reading_timestamp) as day_of_week,
        FORMAT_DATETIME(reading_timestamp, 'EEEE') as day_name,

        -- Glucose classification (ADA guidelines)
        CASE
            WHEN glucose_mg_dl &lt; 70 THEN 'hypoglycemia'
            WHEN glucose_mg_dl &gt;= 70 AND glucose_mg_dl &lt;= 180 THEN 'in_range'
            WHEN glucose_mg_dl &gt; 180 AND glucose_mg_dl &lt;= 250 THEN 'hyperglycemia_mild'
            WHEN glucose_mg_dl &gt; 250 THEN 'hyperglycemia_severe'
        END as glucose_category,

        -- Time in range flag
        CASE
            WHEN glucose_mg_dl &gt;= 70 AND glucose_mg_dl &lt;= 180 THEN 1
            ELSE 0
        END as is_in_range,

        -- Rate of change
        glucose_mg_dl - LAG(glucose_mg_dl) OVER (
            PARTITION BY device ORDER BY reading_timestamp
        ) as glucose_change_mg_dl,

        -- Minutes since last reading
        DATE_DIFF('minute',
            LAG(reading_timestamp) OVER (
                PARTITION BY device ORDER BY reading_timestamp
            ),
            reading_timestamp
        ) as minutes_since_last_reading

    FROM glucose_data
)

SELECT * FROM enriched
ORDER BY reading_timestamp DESC
</code></pre>
<p><strong>Features added</strong>:</p>
<ul>
<li>Time dimensions (hour, day, etc.)</li>
<li>Glucose categories (hypoglycemia/in-range/hyperglycemia)</li>
<li>Time in range indicator</li>
<li>Rate of change (lag window function)</li>
<li>Interval between readings</li>
</ul>
<h2 id="step-5-gold-layer-metrics">Step 5: Gold Layer Metrics</h2>
<h3 id="dbt-model-summarized-metrics">dbt Model: Summarized Metrics</h3>
<pre><code class="language-sql">-- File: workflows/transforms/dbt/models/gold/mrt_glucose_readings.sql

{{ config(
    materialized='table',
    tags=['nightscout', 'metrics']
) }}

SELECT
    reading_date,
    hour_of_day,

    -- Glucose statistics
    COUNT(*) as reading_count,
    ROUND(AVG(glucose_mg_dl), 1) as avg_glucose,
    MIN(glucose_mg_dl) as min_glucose,
    MAX(glucose_mg_dl) as max_glucose,

    -- Time in range
    ROUND(100.0 * SUM(is_in_range) / COUNT(*), 1) as percent_in_range,

    -- Glucose categories
    COUNT(CASE WHEN glucose_category = 'hypoglycemia' THEN 1 END) as hypoglycemia_count,
    COUNT(CASE WHEN glucose_category = 'in_range' THEN 1 END) as in_range_count,
    COUNT(CASE WHEN glucose_category = 'hyperglycemia_mild' THEN 1 END) as hyperglycemia_mild_count,
    COUNT(CASE WHEN glucose_category = 'hyperglycemia_severe' THEN 1 END) as hyperglycemia_severe_count

FROM {{ ref('fct_glucose_readings') }}

GROUP BY reading_date, hour_of_day
ORDER BY reading_date DESC, hour_of_day DESC
</code></pre>
<p><strong>Metrics</strong>:</p>
<ul>
<li>Average glucose per hour</li>
<li>Time in range percentage</li>
<li>Hypoglycemia warnings</li>
<li>Hyperglycemia counts</li>
</ul>
<h2 id="step-6-publishing-to-postgres">Step 6: Publishing to Postgres</h2>
<h3 id="dbt-model-bi-ready-marts">dbt Model: BI-Ready Marts</h3>
<pre><code class="language-sql">-- File: workflows/transforms/dbt/models/marts_postgres/mrt_glucose_overview.sql

{{ config(
    materialized='table',
    meta={'external_database': 'postgres'}
) }}

SELECT
    reading_date,

    -- Daily stats
    COUNT(*) as total_readings,
    ROUND(AVG(glucose_mg_dl), 1) as avg_glucose_mg_dl,
    MIN(glucose_mg_dl) as min_glucose_mg_dl,
    MAX(glucose_mg_dl) as max_glucose_mg_dl,
    ROUND(STDDEV(glucose_mg_dl), 1) as stddev_glucose,

    -- Time in range
    ROUND(100.0 * SUM(is_in_range) / COUNT(*), 1) as percent_in_range,

    -- Alerts
    CASE
        WHEN COUNT(CASE WHEN glucose_category = 'hypoglycemia' THEN 1 END) &gt; 3 THEN 'CRITICAL'
        WHEN COUNT(CASE WHEN glucose_category = 'hyperglycemia_severe' THEN 1 END) &gt; 5 THEN 'ALERT'
        ELSE 'OK'
    END as day_status

FROM {{ ref('fct_glucose_readings') }}

WHERE reading_date &gt;= CURRENT_DATE - INTERVAL '30' DAY

GROUP BY reading_date
ORDER BY reading_date DESC
</code></pre>
<p><strong>Note</strong>: Marts are built in Iceberg first, then auto-published to Postgres.</p>
<h3 id="auto-publishing-iceberg-marts-postgres">Auto-Publishing: Iceberg Marts â†’ Postgres</h3>
<p>Phlo automatically discovers dbt models in the <code>marts</code> schema and creates a <code>publish_marts_to_postgres</code> asset:</p>
<pre><code class="language-python"># This is auto-generated by phlo.framework.discovery._discover_publishing_assets()
# You don't need to write this code - Phlo creates it automatically!

@asset(
    name=&quot;publish_marts_to_postgres&quot;,
    group_name=&quot;publishing&quot;,
    deps=[AssetKey(&quot;mrt_glucose_overview&quot;), AssetKey(&quot;mrt_glucose_hourly_patterns&quot;)],
    kinds={&quot;trino&quot;, &quot;postgres&quot;},
    description=&quot;Publish mart tables from Iceberg to PostgreSQL for BI&quot;,
)
def publish_marts_to_postgres(context):
    &quot;&quot;&quot;Auto-generated publishing asset for dbt marts.&quot;&quot;&quot;
    trino = TrinoResource()
    conn = trino.get_connection()
    cursor = conn.cursor()

    # Create marts schema in postgres if not exists
    cursor.execute(&quot;CREATE SCHEMA IF NOT EXISTS postgres.marts&quot;)

    # For each mart table discovered in dbt manifest:
    for table_name in [&quot;mrt_glucose_overview&quot;, &quot;mrt_glucose_hourly_patterns&quot;]:
        source = f&quot;iceberg.marts.{table_name}&quot;
        target = f&quot;postgres.marts.{table_name}&quot;

        # Drop and recreate (simple refresh)
        cursor.execute(f&quot;DROP TABLE IF EXISTS {target}&quot;)
        cursor.execute(f&quot;CREATE TABLE {target} AS SELECT * FROM {source}&quot;)

        context.log.info(f&quot;Published {table_name} to Postgres&quot;)
</code></pre>
<p><strong>How it works:</strong></p>
<ol>
<li>Phlo scans the dbt <code>manifest.json</code> for models in the <code>marts</code> schema</li>
<li>Auto-generates a publishing asset with dependencies on those marts</li>
<li>Uses Trino to copy data from Iceberg (<code>iceberg.marts.*</code>) to Postgres (<code>postgres.marts.*</code>)</li>
</ol>
<p>You don't need to write any publishing code - just create dbt models in the <code>marts</code> schema!</p>
<h2 id="step-7-running-the-full-pipeline">Step 7: Running the Full Pipeline</h2>
<h3 id="materialize-everything">Materialize Everything</h3>
<pre><code class="language-bash"># Run all glucose assets for a specific date
phlo materialize \
  --select &quot;dlt_glucose_entries,stg_glucose_entries,fct_glucose_readings,mrt_glucose_readings,publish_glucose_marts&quot; \
  --partition 2024-10-15

# Output:
# Materializing dlt_glucose_entries [2024-10-15]
#   Successfully fetched 288 entries
#   Merged 288 rows to iceberg
#   Asset materialized in 2.45s
#
# Materializing stg_glucose_entries [2024-10-15]
#   dbt build completed
#   Asset materialized in 1.23s
#
# Materializing fct_glucose_readings [2024-10-15]
#   dbt run completed
#   Asset materialized in 3.42s
#
# Materializing mrt_glucose_readings [2024-10-15]
#   dbt run completed
#   Asset materialized in 1.15s
#
# Materializing publish_glucose_marts
#   Published 1 daily record to Postgres
#   Published 24 hourly records to Postgres
#   Asset materialized in 0.67s
#
# All assets materialized successfully in 8.92s
</code></pre>
<p><strong>In Dagster</strong>:</p>
<pre><code>http://localhost:10006
â†’ Assets tab
â†’ dlt_glucose_entries
â†’ Click to view lineage graph with status
</code></pre>
<p><strong>In Observatory</strong>:</p>
<pre><code>http://localhost:3001
â†’ Data Explorer
â†’ Browse marts.mrt_glucose_overview
â†’ Preview data and run queries
</code></pre>
<p><strong>In Postgres</strong>:</p>
<pre><code class="language-bash">docker exec -it pg psql -U phlo lakehouse

lakehouse=# SELECT * FROM marts.mrt_glucose_overview ORDER BY reading_date DESC LIMIT 1;

reading_date | avg_glucose_mg_dl | min_glucose_mg_dl | max_glucose_mg_dl | percent_in_range
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2024-10-15   | 145.3             | 89                | 210               | 78.2
</code></pre>
<h2 id="step-8-monitoring-and-alerts">Step 8: Monitoring and Alerts</h2>
<h3 id="quality-checks-with-phlo_quality">Quality Checks with @phlo_quality</h3>
<p>Phlo provides two approaches for quality checks. The declarative <code>@phlo_quality</code> decorator:</p>
<pre><code class="language-python"># File: phlo-examples/nightscout/workflows/quality/nightscout.py

import phlo
from phlo_quality import NullCheck, RangeCheck, FreshnessCheck

@phlo_quality(
    table=&quot;silver.fct_glucose_readings&quot;,
    checks=[
        NullCheck(columns=[&quot;entry_id&quot;, &quot;glucose_mg_dl&quot;, &quot;reading_timestamp&quot;]),
        RangeCheck(column=&quot;glucose_mg_dl&quot;, min_value=20, max_value=600),
        RangeCheck(column=&quot;hour_of_day&quot;, min_value=0, max_value=23),
        FreshnessCheck(column=&quot;reading_timestamp&quot;, max_age_hours=24),
    ],
    group=&quot;nightscout&quot;,
    blocking=True,
)
def glucose_readings_quality():
    &quot;&quot;&quot;Declarative quality checks for glucose readings using @phlo_quality.&quot;&quot;&quot;
    pass
</code></pre>
<p>And the traditional <code>@asset_check</code> for custom logic:</p>
<pre><code class="language-python"># File: phlo-examples/nightscout/workflows/quality/nightscout.py

from dagster import AssetCheckResult, AssetKey, asset_check
from workflows.schemas.nightscout import FactGlucoseReadings

@asset_check(
    name=&quot;nightscout_glucose_quality&quot;,
    asset=AssetKey([&quot;fct_glucose_readings&quot;]),
    blocking=True,
    description=&quot;Validate processed Nightscout glucose data using Pandera schema validation.&quot;,
)
def nightscout_glucose_quality_check(context, trino: TrinoResource) -&gt; AssetCheckResult:
    &quot;&quot;&quot;Quality check using Pandera for type-safe schema validation.&quot;&quot;&quot;

    query = &quot;&quot;&quot;
    SELECT
        entry_id, glucose_mg_dl, reading_timestamp, direction,
        hour_of_day, day_of_week, glucose_category, is_in_range
    FROM iceberg_dev.silver.fct_glucose_readings
    &quot;&quot;&quot;

    with trino.cursor(schema=&quot;silver&quot;) as cursor:
        cursor.execute(query)
        rows = cursor.fetchall()
        columns = [desc[0] for desc in cursor.description]

    fact_df = pd.DataFrame(rows, columns=columns)

    # Validate with Pandera schema
    try:
        FactGlucoseReadings.validate(fact_df, lazy=True)
        return AssetCheckResult(
            passed=True,
            metadata={
                &quot;rows_validated&quot;: len(fact_df),
                &quot;columns_validated&quot;: len(fact_df.columns),
            },
        )
    except pandera.errors.SchemaErrors as err:
        return AssetCheckResult(
            passed=False,
            metadata={
                &quot;failed_checks&quot;: len(err.failure_cases),
                &quot;failures_by_column&quot;: err.failure_cases.groupby(&quot;column&quot;).size().to_dict(),
            },
        )
</code></pre>
<p><strong>Alerts</strong>: If checks fail:</p>
<ul>
<li>Dagster UI shows red</li>
<li>ğŸ“§ Optional: send to Slack/email</li>
<li>ğŸ”” Dashboard shows warnings</li>
</ul>
<h2 id="complete-data-flow-diagram">Complete Data Flow Diagram</h2>
<pre><code>â”Œâ”€ Nightscout API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 288 readings/day                  â”‚
â”‚ 5-min intervals                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ INGESTION (2.45s) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ dlt_glucose_entries                       â”‚
â”‚ â”œâ”€ Fetch from API (288 rows)              â”‚
â”‚ â”œâ”€ Validate with Pandera [PASSED]         â”‚
â”‚ â”œâ”€ Stage to S3 parquet                    â”‚
â”‚ â””â”€ Merge to iceberg raw.glucose_entries   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ TRANSFORM BRONZE (1.23s) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ stg_glucose_entries                       â”‚
â”‚ â”œâ”€ Type conversions                       â”‚
â”‚ â”œâ”€ Rename columns                         â”‚
â”‚ â”œâ”€ Filter nulls &amp; out-of-range            â”‚
â”‚ â””â”€ Create view in bronze.*                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ TRANSFORM SILVER (3.42s) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ fct_glucose_readings                      â”‚
â”‚ â”œâ”€ Add time dimensions                    â”‚
â”‚ â”œâ”€ Classify glucose (hypo/in-range/hyper) â”‚
â”‚ â”œâ”€ Calculate rate of change (window fn)   â”‚
â”‚ â””â”€ Create table in silver.*               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ TRANSFORM GOLD (1.15s) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ mrt_glucose_readings                      â”‚
â”‚ â”œâ”€ Aggregate by hour                      â”‚
â”‚ â”œâ”€ Calculate % time in range               â”‚
â”‚ â”œâ”€ Count by category                      â”‚
â”‚ â””â”€ Create table in gold.*                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ PUBLISH (0.67s) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ publish_glucose_marts                    â”‚
â”‚ â”œâ”€ Query Iceberg gold tables              â”‚
â”‚ â”œâ”€ Truncate Postgres marts                â”‚
â”‚ â””â”€ Insert results (1 daily + 24 hourly)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ ANALYTICS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Superset Dashboard                â”‚
â”‚ â”œâ”€ Daily avg glucose: 145.3 mg/dL â”‚
â”‚ â”œâ”€ Time in range: 78.2%           â”‚
â”‚ â”œâ”€ Hourly patterns graph           â”‚
â”‚ â””â”€ 30-day trend                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Total pipeline time: 8.92s
</code></pre>
<h2 id="key-takeaways">Key Takeaways</h2>
<p><strong>End-to-end pipeline</strong> from API to dashboard
<strong>Idempotent ingestion</strong> - safe to re-run
<strong>Type-safe transformations</strong> via dbt
<strong>Data quality checks</strong> with Pandera &amp; Dagster
<strong>Audit trail</strong> via Nessie versioning
<strong>Scalable</strong> to millions of rows
<strong>Observable</strong> with logs, metrics, dashboards</p>
<p>This is real-world data engineering:</p>
<ul>
<li>Start with raw data (APIs, files, databases)</li>
<li>Validate early (Pandera schemas)</li>
<li>Transform incrementally (bronze â†’ silver â†’ gold)</li>
<li>Publish for consumption (Postgres, dashboards)</li>
<li>Monitor quality (tests, checks, alerts)</li>
</ul>
<h2 id="next-steps">Next Steps</h2>
<p>To extend this example:</p>
<ol>
<li><strong>Add more data sources</strong>: GitHub, Fitbit, weather, etc.</li>
<li><strong>Advanced analytics</strong>: Anomaly detection, forecasting</li>
<li><strong>Real-time alerts</strong>: Slack notifications for hypoglycemia</li>
<li><strong>Retention policies</strong>: Archive old data, keep recent data hot</li>
<li><strong>ML integration</strong>: Predict glucose trends</li>
</ol>
<p>The pattern remains:
<strong>Ingest â†’ Validate â†’ Transform â†’ Publish â†’ Monitor</strong></p>
<h2 id="summary">Summary</h2>
<p>You now understand:</p>
<ul>
<li>Modern data lakehouse architecture (Iceberg, Nessie)</li>
<li>Complete ingestion pattern (DLT, PyIceberg)</li>
<li>SQL transformation best practices (dbt layers)</li>
<li>Production orchestration (Dagster assets)</li>
<li>Data quality and testing</li>
<li>Real-world example building dashboards</li>
</ul>
<p>Time to build your own pipelines!</p>
<p>See the <a href="../../">main docs</a> for API references, troubleshooting, and production deployment guides.</p>
<p><strong>Next</strong>: <a href="../09-data-quality-with-pandera/">Part 9: Data Quality with Pandera</a></p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.expand", "navigation.prune", "navigation.indexes", "content.tabs.link", "content.code.annotation", "content.code.copy", "content.code.select", "search.suggest", "search.highlight", "search.share"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>